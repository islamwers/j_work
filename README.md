# 📘 Python-гайд по синтаксису и фильтрации для анализа данных (pandas)

Этот гайд — краткий, но достаточный минимум для решения типовых заданий по табличным данным:
- почему функции пишутся со скобками `()`;
- как обращаться к колонкам через `[]`;
- как фильтровать строки и комбинировать условия;
- как работает точка `.` (методы объектов);
- как считать количество строк;
- как обрабатывать дату/время;
- как найти всю строку с максимумом (`idxmax` + `loc`);
- как посчитать IQR (межквартильный размах).

Примеры рассчитаны на таблицу Airbnb-подобных данных (например, `train_B.csv`).

---

## 1) Загрузка данных

```python
import pandas as pd

# CSV:
df = pd.read_csv("train_B.csv")

# Excel:
# df = pd.read_excel("train_B.xlsx")
```

Полезно сразу посмотреть структуру:
```python
df.head()     # первые строки
df.info()     # типы колонок и пропуски
df.columns    # список колонок
```
2) Почему функции пишутся со скобками ()

В Python функция — это действие, которое нужно вызвать, чтобы оно выполнилось.
Скобки () запускают выполнение и передают аргументы.

```python
max([3, 1, 9])   # вернёт 9
len(df)          # вернёт количество строк
print("Hello!")  # выведет текст
```

max без скобок — это просто имя функции (ссылка), она не выполнится.

Даже без аргументов скобки нужны: func().

3) Как обращаться к колонкам через []

df — это таблица (DataFrame).
Доступ к колонке выполняется по имени в квадратных скобках — как к значению по ключу в словаре:

```python
df['price']       # столбец с ценами (Series)
df['room type']   # столбец с типом комнаты
```

Колонка — это объект Series, к нему можно применять методы:
```python
df['price'].max()
df['price'].mean()
df['room type'].unique()
```

4) Фильтрация строк по условию

Базовый шаблон: df[условие].
```python
df[df['price'] > 100]  # строки, где цена > 100
```
Комбинация условий

- & — логическое И

- | — логическое ИЛИ

- ==, >, <, >=, <= — сравнения

Важно: каждое условие берём в скобки ().

Частые паттерны
```python
# Несколько значений:
df[df['borough'].isin(['Brooklyn', 'Queens'])]

# Строковые подстроки (предварительно убедись, что тип — str):
df[df['name'].str.contains('cozy', case=False, na=False)]

# Удалить строки с пропусками в нужных колонках:
clean = df.dropna(subset=['price', 'room type'])
```

5) Точка .: вызов методов объектов

Точка . обращается к методу или атрибуту конкретного объекта.
Примеры полезных методов для колонок (Series):

| Метод                 | Назначение                          |
| --------------------- | ----------------------------------- |
| `.mean()`             | среднее значение                    |
| `.median()`           | медиана                             |
| `.max()`, `.min()`    | максимум / минимум                  |
| `.value_counts()`     | количество уникальных категорий     |
| `.unique()`           | уникальные значения                 |
| `.quantile(q)`        | квантиль (например, `0.25`, `0.75`) |
| `.isna()`, `.notna()` | проверка на пропуски                |

Примеры:

```python
df['price'].mean()
df['room type'].value_counts()
df['price'].quantile(0.25), df['price'].quantile(0.75)
```

6) Подсчёт количества строк: len(...)

```python
len(df)                               # общее число строк
len(df[df['price'] > 200])            # строк с ценой > 200
len(df[(df['borough'] == 'Brooklyn') & (df['price'] <= 100)])
```

7) Работа с датой/временем
Приведение текста к datetime
```python
df['last booking'] = pd.to_datetime(df['last booking'], errors='coerce')

Извлечение компонентов
df['booking_hour'] = df['last booking'].dt.hour
df['booking_date'] = df['last booking'].dt.date
df['booking_weekday'] = df['last booking'].dt.day_name()  # имя дня недели

Фильтр по времени (например, 04:00–11:59)
morning = df[(df['booking_hour'] >= 4) & (df['booking_hour'] <= 11)]
len(morning)
```

💡 Совет: всегда сначала приводите колонку к datetime, иначе .dt не сработает.

8) Найти всю строку с максимумом: idxmax() + loc

Если нужно не просто число-максимум, а вся запись, где он встретился:
```python
idx = df['price'].idxmax()  # индекс строки с max ценой
row = df.loc[idx]           # вся строка
```

Коротко:
```python
df.loc[df['price'].idxmax()]
```

Комбинация с фильтрацией (например, только Shared room 2009 года):
```python
filtered = df[(df['room type'] == 'Shared room') & (df['construction year'] == 2009)]
top_row = filtered.loc[filtered['price'].idxmax()]
```






